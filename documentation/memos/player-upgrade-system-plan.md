# ç©å®¶å‡çº§ç³»ç»Ÿå®æ–½è®¡åˆ’

**åˆ›å»ºæ—¶é—´**: 2025-11-18
**çŠ¶æ€**: è®¾è®¡é˜¶æ®µï¼ˆå¾…å®æ–½ï¼‰
**è®¾è®¡ç†å¿µ**: Roguelikeæ³¢æ¬¡æ°¸ä¹…æˆé•¿ç³»ç»Ÿ
**ç›®æ ‡é€šå…³ç‡**: 40-60%ï¼ˆä¸­ç­‰éš¾åº¦ï¼‰

---

## ğŸ“‹ æ€»ä½“ç›®æ ‡

å®æ–½**Roguelikeæ³¢æ¬¡æ°¸ä¹…æˆé•¿ç³»ç»Ÿ**é…åˆ**æ•ŒäººAIå¼ºåŒ–ï¼ˆé¢„æµ‹å°„å‡»+è§’è‰²åˆ†å·¥ï¼‰**ï¼Œé€šè¿‡ç©å®¶èƒ½åŠ›æå‡å¹³è¡¡æ•ŒäººAIå¼ºåŒ–ï¼Œè¾¾åˆ°40-60%é€šå…³ç‡çš„ä¸­ç­‰éš¾åº¦å¹³è¡¡ã€‚

---

## ğŸ¯ è®¾è®¡èƒŒæ™¯

### å½“å‰ç©å®¶èƒ½åŠ›ç°çŠ¶ï¼ˆâœ“ äº‹å®ï¼‰

**åŸºç¡€å±æ€§**:
- åˆå§‹ç”Ÿå‘½ï¼š3æ¡å‘½
- ç§»åŠ¨é€Ÿåº¦ï¼š250 px/sï¼ˆä»…æ°´å¹³ç§»åŠ¨ï¼‰
- å°„é€Ÿï¼š250mså†·å´ï¼ˆPCï¼š4å‘/ç§’ï¼Œç§»åŠ¨ç«¯ï¼š2å‘/ç§’ï¼‰
- å­å¼¹é€Ÿåº¦ï¼š400 px/sï¼ˆç›´çº¿å‘ä¸Šï¼‰
- ç¢°æ’ç®±ï¼š40x40åƒç´ 

**èƒ½åŠ›é™åˆ¶**:
- æ— é“å…·ç³»ç»Ÿ
- æ— æŠ€èƒ½ç³»ç»Ÿ
- æ— å‡çº§æœºåˆ¶
- å•ä¸€æ”»å‡»æ–¹å¼ï¼ˆç›´çº¿å•å‘å°„å‡»ï¼‰

### æ•ŒäººAIå¼ºåŒ–åçš„æŒ‘æˆ˜ï¼ˆğŸ¤” æ¨ç†ï¼‰

**æ–¹æ¡ˆ1ï¼ˆé¢„æµ‹å°„å‡»ï¼‰å®æ–½å**:
- æ•Œäººä¼šç²¾å‡†ç„å‡†ç©å®¶ä½ç½®
- ååº”çª—å£ä»âˆç¼©çŸ­è‡³300-500ms
- èº²é¿éš¾åº¦æå‡çº¦**+70%**

**æ–¹æ¡ˆ4ï¼ˆè§’è‰²åˆ†å·¥ï¼‰å®æ–½å**:
- ç‹™å‡»æ‰‹ï¼šç²¾å‡†é«˜å¨èƒ
- æœºæªæ‰‹ï¼šé«˜å°„é€Ÿå‹åˆ¶
- å¦å…‹ï¼šéœ€è¦2å‘å‡»æ€
- æ•´ä½“éš¾åº¦æå‡çº¦**+80%**

**ç»¼åˆéš¾åº¦æå‡**ï¼šçº¦**+150%**

**ç»“è®º**: å¦‚æœä¸å¢å¼ºç©å®¶èƒ½åŠ›ï¼Œéš¾åº¦å°†ä»"ä¸­ç­‰"æš´æ¶¨åˆ°"å‡ ä¹ä¸å¯èƒ½"ã€‚

---

## ğŸ® æ ¸å¿ƒç³»ç»Ÿè®¾è®¡

### **1. Roguelikeæ³¢æ¬¡æ°¸ä¹…æˆé•¿ç³»ç»Ÿ**

#### 1.1 åŸºç¡€æœºåˆ¶

**è§¦å‘æ—¶æœº**:
- æ¯æ³¢é€šå…³åï¼ˆæ¶ˆç­æ‰€æœ‰æ•Œäººï¼‰
- æ¸¸æˆè‡ªåŠ¨æš‚åœ
- æ˜¾ç¤ºå‡çº§é€‰æ‹©UI

**é€‰æ‹©æµç¨‹**:
1. ç³»ç»Ÿéšæœºç”Ÿæˆ3ä¸ªå‡çº§é€‰é¡¹ï¼ˆä¸é‡å¤ï¼‰
2. ç©å®¶ç‚¹å‡»é€‰æ‹©å…¶ä¸­1ä¸ª
3. å‡çº§ç«‹å³ç”Ÿæ•ˆå¹¶æ°¸ä¹…ä¿æŒï¼ˆæœ¬å±€å†…ï¼‰
4. UIæ¶ˆå¤±ï¼Œè¿›å…¥ä¸‹ä¸€æ³¢

**é‡ç½®è§„åˆ™**:
- æ­»äº¡åé‡æ–°å¼€å§‹ï¼Œæ‰€æœ‰å‡çº§æ¸…ç©º
- æ¯å±€éƒ½æ˜¯å…¨æ–°æˆé•¿è·¯çº¿

#### 1.2 å‡çº§é€‰é¡¹æ± è®¾è®¡ï¼ˆ15ä¸ªï¼‰

##### æ”»å‡»ç±»ï¼ˆ6ä¸ªï¼‰

| ç¼–å· | åç§° | æ•ˆæœ | å†²çªè§„åˆ™ |
|------|------|------|---------|
| 1 | åŒå‘æ•£å¼¹ | å°„å‡º2å‘å­å¼¹ï¼ˆÂ±15åº¦è§’ï¼‰ | ä¸"ä¸‰å‘æ•£å¼¹"äº’æ–¥ |
| 2 | ä¸‰å‘æ•£å¼¹ | å°„å‡º3å‘å­å¼¹ï¼ˆ-20/0/+20åº¦è§’ï¼‰ | è¦†ç›–"åŒå‘æ•£å¼¹" |
| 3 | ç©¿é€å­å¼¹ | å­å¼¹å‡»ä¸­æ•Œäººåä¸æ¶ˆå¤±ï¼Œå¯å‡»ç©¿æ‰€æœ‰æ•Œäºº | æ— å†²çª |
| 4 | å°„é€Ÿå¼ºåŒ–I | å°„å‡»å†·å´æ—¶é—´-25%ï¼ˆ250msâ†’187msï¼‰ | å¯ä¸IIå åŠ  |
| 5 | å°„é€Ÿå¼ºåŒ–II | å°„å‡»å†·å´æ—¶é—´-25%ï¼ˆåŸºäºå½“å‰å€¼ï¼‰ | å¯ä¸Iå åŠ  |
| 6 | å­å¼¹åŠ é€Ÿ | å­å¼¹é€Ÿåº¦+30%ï¼ˆ400â†’520 px/sï¼‰ | å¯å åŠ  |

**è®¾è®¡è¯´æ˜**:
- åŒå‘/ä¸‰å‘æ•£å¼¹ï¼šåº”å¯¹è§’è‰²åˆ†å·¥ç³»ç»Ÿï¼ˆå¤šç›®æ ‡ï¼‰
- ç©¿é€å­å¼¹ï¼šåº”å¯¹å¦å…‹ï¼ˆ2è¡€ï¼‰å’Œå¯†é›†é˜µå‹
- å°„é€Ÿå¼ºåŒ–ï¼šæå‡æ€»ä½“DPS
- å­å¼¹åŠ é€Ÿï¼šç¼©çŸ­æ•Œäººååº”æ—¶é—´

##### é˜²å¾¡ç±»ï¼ˆ5ä¸ªï¼‰

| ç¼–å· | åç§° | æ•ˆæœ | å†²çªè§„åˆ™ |
|------|------|------|---------|
| 7 | é¢å¤–ç”Ÿå‘½ | æœ€å¤§ç”Ÿå‘½+1æ¡ | å¯å¤šæ¬¡æ‹¾å– |
| 8 | æ•æ·å¼ºåŒ– | ç§»åŠ¨é€Ÿåº¦+20%ï¼ˆ250â†’300â†’360 px/sï¼‰ | å¯å åŠ ï¼ˆæœ€å¤§3æ¬¡ï¼‰ |
| 9 | ä½“å‹ç¼©å° | ç¢°æ’ç®±ç¼©å°25%ï¼ˆ40x40â†’30x30ï¼‰ | ä»…ä¸€æ¬¡æœ‰æ•ˆ |
| 10 | é‡‘åˆšä¸å | å—å‡»åæ— æ•Œæ—¶é—´+50%ï¼ˆ500msâ†’750msï¼‰ | å¯å åŠ  |
| 11 | æˆ˜åœ°åŒ»ç–— | æ¯æ³¢å¼€å§‹æ—¶å›å¤1æ¡ç”Ÿå‘½ | æ— å†²çª |

**è®¾è®¡è¯´æ˜**:
- é¢å¤–ç”Ÿå‘½ï¼šæå‡å®¹é”™ç‡
- æ•æ·å¼ºåŒ–ï¼šåº”å¯¹é¢„æµ‹å°„å‡»ï¼ˆç§»é€Ÿè¶Šå¿«è¶Šéš¾é¢„åˆ¤ï¼‰
- ä½“å‹ç¼©å°ï¼šé™ä½è¢«å‡»ä¸­æ¦‚ç‡
- é‡‘åˆšä¸åï¼šå—å‡»åæ›´å®‰å…¨
- æˆ˜åœ°åŒ»ç–—ï¼šé•¿æœŸç”Ÿå­˜èƒ½åŠ›

##### ç‰¹æ®Šç±»ï¼ˆ4ä¸ªï¼‰

| ç¼–å· | åç§° | æ•ˆæœ | å†²çªè§„åˆ™ |
|------|------|------|---------|
| 12 | è‡´å‘½ä¸€å‡» | 10%æ¦‚ç‡é€ æˆ2å€ä¼¤å®³ï¼ˆç§’æ€å¦å…‹ï¼‰ | æ— å†²çª |
| 13 | è¿æ€ç‹‚æš´ | è¿ç»­å‡»æ€3ä¸ªæ•Œäººåç§»é€Ÿ+30%ï¼ˆæŒç»­3ç§’ï¼‰ | æ— å†²çª |
| 14 | å¼¹å¹•æ¸…é™¤ | æ¯æ³¢å¼€å§‹æ—¶æ¸…ç©ºæ‰€æœ‰æ•Œäººå­å¼¹ | ä»…ä¸€æ¬¡æœ‰æ•ˆ |
| 15 | ç”Ÿå‘½æ±²å– | å‡»æ€æ•Œäºº5%æ¦‚ç‡å›å¤1æ¡ç”Ÿå‘½ | æ— å†²çª |

**è®¾è®¡è¯´æ˜**:
- è‡´å‘½ä¸€å‡»ï¼šåº”å¯¹å¦å…‹ï¼ˆé™ä½å‡»æ€æ‰€éœ€å¼¹è¯ï¼‰
- è¿æ€ç‹‚æš´ï¼šå¥–åŠ±è¿›æ”»æ€§ç©æ³•
- å¼¹å¹•æ¸…é™¤ï¼šåº”å¯¹é«˜ç«åŠ›æ³¢æ¬¡
- ç”Ÿå‘½æ±²å–ï¼šå¥–åŠ±é«˜å‘½ä¸­ç‡ç©æ³•

#### 1.3 å‡çº§é€‰æ‹©ç®—æ³•

```javascript
// ä¼ªä»£ç ç¤ºä¾‹
generateUpgradeOptions(playerCurrentUpgrades) {
  const availableUpgrades = ALL_UPGRADES.filter(upgrade => {
    // è¿‡æ»¤è§„åˆ™
    if (upgrade.maxStack && playerCurrentUpgrades[upgrade.id] >= upgrade.maxStack) {
      return false; // å·²è¾¾åˆ°å åŠ ä¸Šé™
    }
    if (upgrade.conflicts && playerCurrentUpgrades.includes(upgrade.conflicts)) {
      return false; // å­˜åœ¨å†²çªå‡çº§
    }
    return true;
  });

  // éšæœºé€‰æ‹©3ä¸ªï¼ˆå¸¦æƒé‡ï¼‰
  return weightedRandomSelect(availableUpgrades, 3);
}
```

**æƒé‡è®¾è®¡**ï¼ˆ**ä¼°è®¡**ï¼Œéœ€æµ‹è¯•è°ƒæ•´ï¼‰:
- æ”»å‡»ç±»ï¼š40%
- é˜²å¾¡ç±»ï¼š40%
- ç‰¹æ®Šç±»ï¼š20%

#### 1.4 å‡çº§æ•ˆæœå®ç°æ–¹å¼

**å±æ€§ä¿®æ”¹**ï¼ˆå­˜å‚¨åœ¨ç©å®¶å¯¹è±¡ï¼‰:
```javascript
this.player.setData('shootCooldown', 187); // å°„é€Ÿå¼ºåŒ–
this.player.setData('moveSpeed', 300);     // æ•æ·å¼ºåŒ–
this.player.setData('bulletPattern', 'triple'); // ä¸‰å‘æ•£å¼¹
this.player.setData('bulletPenetrate', true);   // ç©¿é€å­å¼¹
```

**æ£€æµ‹ä½ç½®**:
- å°„å‡»é€»è¾‘ï¼š`BulletManager.shootPlayerBullet()`
- ç§»åŠ¨é€»è¾‘ï¼š`InputManager.update()`
- ç¢°æ’æ£€æµ‹ï¼š`GameScene.hitEnemy()`

---

### **2. æ•ŒäººAIå¼ºåŒ–ç³»ç»Ÿï¼ˆé…åˆå®æ–½ï¼‰**

#### 2.1 æ–¹æ¡ˆ1ï¼šé¢„æµ‹æ€§å°„å‡»ç³»ç»Ÿ

**è®¾è®¡ç›®æ ‡**: è®©æ•Œäººå°„å‡»æœ‰å¯é¢„æµ‹æ€§ï¼Œç»™ç©å®¶ååº”çª—å£

**å®ç°å‚æ•°**ï¼ˆæ·»åŠ åˆ° GameConfig.jsï¼‰:

```javascript
ENEMY: {
  TARGETING: {
    ENABLED_FROM_WAVE: 2,        // ä»ç¬¬2æ³¢å¼€å§‹å¯ç”¨ç„å‡†
    ACCURACY_BY_WAVE: [          // æ¯æ³¢ç²¾åº¦ï¼ˆ0-1ï¼‰
      0,    // Wave 1: å…³é—­ç„å‡†
      0.60, // Wave 2: 60%ç²¾åº¦
      0.70, // Wave 3: 70%ç²¾åº¦
      0.80, // Wave 4: 80%ç²¾åº¦
      0.90  // Wave 5: 90%ç²¾åº¦
    ],
    REACTION_BASE: 500,          // åŸºç¡€ååº”çª—å£ (ms)
    REACTION_DECAY_PER_WAVE: 50, // æ¯æ³¢é€’å‡ (ms)
    REACTION_MIN: 300,           // æœ€å°ååº”çª—å£ (ms)
    PREDICTION_FACTOR: 0.3,      // é¢„åˆ¤ç³»æ•°ï¼ˆè€ƒè™‘ç©å®¶é€Ÿåº¦ï¼‰
    WARNING_DURATION: 200        // å°„å‡»å‰è­¦å‘Šæ—¶é—´ (ms)
  }
}
```

**å°„å‡»é€»è¾‘**ï¼ˆä¿®æ”¹ BulletManager.jsï¼‰:

```javascript
shootAtPlayer(enemy, player, wave) {
  const config = GameConfig.ENEMY.TARGETING;
  const accuracy = config.ACCURACY_BY_WAVE[wave];
  const reactionWindow = Math.max(
    config.REACTION_BASE - wave * config.REACTION_DECAY_PER_WAVE,
    config.REACTION_MIN
  );

  // 1. è§†è§‰è­¦å‘Šï¼ˆæ•Œäººå˜çº¢ï¼‰
  this.showShootWarning(enemy);

  // 2. å»¶è¿Ÿå°„å‡»ï¼ˆç»™ç©å®¶ååº”æ—¶é—´ï¼‰
  this.scene.time.delayedCall(reactionWindow, () => {
    // 3. è®¡ç®—ç„å‡†ä½ç½®ï¼ˆå¸¦é¢„åˆ¤ï¼‰
    const predictedX = player.x + player.body.velocity.x * config.PREDICTION_FACTOR;
    const predictedY = player.y;

    // 4. æ·»åŠ ç²¾åº¦è¯¯å·®
    const errorX = (1 - accuracy) * Phaser.Math.Between(-50, 50);
    const targetX = predictedX + errorX;

    // 5. è®¡ç®—å°„å‡»è§’åº¦
    const angle = Phaser.Math.Angle.Between(
      enemy.x, enemy.y,
      targetX, predictedY
    );

    // 6. å‘å°„å­å¼¹
    const bullet = this.enemyBullets.create(enemy.x, enemy.y, 'enemyBullet');
    bullet.setVelocity(
      Math.cos(angle) * 200,
      Math.sin(angle) * 200
    );
  });
}

showShootWarning(enemy) {
  enemy.setTint(0xff0000); // å˜çº¢
  this.scene.time.delayedCall(200, () => {
    enemy.clearTint(); // æ¢å¤é¢œè‰²
  });
}
```

#### 2.2 æ–¹æ¡ˆ4ï¼šè§’è‰²åˆ†å·¥ç³»ç»Ÿ

**è®¾è®¡ç›®æ ‡**: èµ‹äºˆæ•Œäººä¸åŒè§’è‰²ï¼Œåˆ›é€ ä¼˜å…ˆçº§å†³ç­–

**è§’è‰²å®šä¹‰è¡¨**:

| è§’è‰² | è¡€é‡ | å°„é€Ÿ | ç²¾åº¦ | ç§»é€Ÿ | é¢œè‰² | å°ºå¯¸ | å æ¯” |
|------|------|------|------|------|------|------|------|
| ç‹™å‡»æ‰‹ | 1 | 2000ms | 95% | 30 px/s | çº¢è‰² | 1.0x | 20% |
| æœºæªæ‰‹ | 1 | 500ms | 30% | 60 px/s | é»„è‰² | 1.0x | 40% |
| å¦å…‹ | 2 | 1500ms | 100% | 20 px/s | ç»¿è‰² | 1.3x | 15% |
| æ™®é€šå…µ | 1 | 1000ms | 60% | 50 px/s | ç™½è‰² | 1.0x | 25% |

**Waveé…ç½®**:

| æ³¢æ¬¡ | è§’è‰²ç»„æˆ | è¯´æ˜ |
|------|---------|------|
| Wave 1 | 100% æ™®é€šå…µï¼ˆæ— ç„å‡†ï¼‰ | æ•™å­¦æ³¢æ¬¡ï¼Œçº¯éšæœºå°„å‡» |
| Wave 2 | 100% æ™®é€šå…µï¼ˆ60%ç„å‡†ï¼‰ | å¼•å…¥é¢„æµ‹å°„å‡» |
| Wave 3 | 30% ç‹™å‡»æ‰‹ + 70% æœºæªæ‰‹ | å¼•å…¥è§’è‰²ç³»ç»Ÿ |
| Wave 4 | 20% ç‹™å‡»æ‰‹ + 40% æœºæªæ‰‹ + 15% å¦å…‹ + 25% æ™®é€šå…µ | å®Œæ•´è§’è‰² |
| Wave 5 | 20% ç‹™å‡»æ‰‹ + 40% æœºæªæ‰‹ + 15% å¦å…‹ + 25% æ™®é€šå…µ | æœ€é«˜éš¾åº¦ |

**å®ç°æ–¹å¼**ï¼ˆä¿®æ”¹ GameScene.jsï¼‰:

```javascript
spawnEnemiesWithRoles(wave) {
  const roleDistribution = GameConfig.ENEMY.ROLE_DISTRIBUTION[wave];

  for (let row = 0; row < 3; row++) {
    for (let col = 0; col < 5; col++) {
      const x = GameConfig.ENEMY_SPAWN.START_X + col * GameConfig.ENEMY_SPAWN.SPACING_X;
      const y = GameConfig.ENEMY_SPAWN.START_Y + row * GameConfig.ENEMY_SPAWN.SPACING_Y;

      // æ ¹æ®æ¦‚ç‡åˆ†é…è§’è‰²
      const role = this.selectRoleByProbability(roleDistribution);
      const enemy = this.enemies.create(x, y, 'enemy');

      // åº”ç”¨è§’è‰²å±æ€§
      this.applyRoleAttributes(enemy, role);
    }
  }
}

applyRoleAttributes(enemy, role) {
  const roleConfig = GameConfig.ENEMY.ROLES[role];

  enemy.setData('role', role);
  enemy.setData('health', roleConfig.health);
  enemy.setData('fireRate', roleConfig.fireRate);
  enemy.setData('accuracy', roleConfig.accuracy);
  enemy.setData('speed', roleConfig.speed);

  // è§†è§‰æ ‡è¯†
  enemy.setTint(roleConfig.tint);
  enemy.setScale(roleConfig.scale || 1.0);
}
```

**è¡€é‡ç³»ç»Ÿå®ç°**ï¼ˆä¿®æ”¹ç¢°æ’æ£€æµ‹ï¼‰:

```javascript
// ä¿®æ”¹ GameScene.js ä¸­çš„ hitEnemy()
hitEnemy(bullet, enemy) {
  bullet.destroy();

  // æ£€æŸ¥æš´å‡»
  const isCritical = this.player.getData('criticalChance') &&
                     Math.random() < 0.1;
  const damage = isCritical ? 2 : 1;

  // æ‰£é™¤è¡€é‡
  const currentHealth = enemy.getData('health');
  const newHealth = currentHealth - damage;

  if (newHealth <= 0) {
    // å‡»æ€æ•Œäºº
    this.scoreManager.addScore(10);
    this.effectsManager.enemyDeathEffect(enemy);
    enemy.destroy();

    // è§¦å‘ç”Ÿå‘½æ±²å–
    if (this.player.getData('lifesteal') && Math.random() < 0.05) {
      this.lives = Math.min(this.lives + 1, this.maxLives);
    }
  } else {
    // å¦å…‹å—ä¼¤ä½†æœªæ­»äº¡
    enemy.setData('health', newHealth);
    enemy.setTint(0xff0000); // å˜çº¢è¡¨ç¤ºå—ä¼¤
    this.time.delayedCall(100, () => {
      const role = enemy.getData('role');
      const roleConfig = GameConfig.ENEMY.ROLES[role];
      enemy.setTint(roleConfig.tint); // æ¢å¤è§’è‰²é¢œè‰²
    });
  }
}
```

---

### **3. åˆå§‹æ•°å€¼è°ƒæ•´**

#### 3.1 ç©å®¶åŸºç¡€å±æ€§ä¿®æ”¹

| å±æ€§ | å½“å‰å€¼ | æ–°å€¼ | å˜åŒ– | ç†ç”± |
|------|--------|------|------|------|
| åˆå§‹ç”Ÿå‘½ | 3æ¡ | **5æ¡** | +67% | æé«˜å®¹é”™ç‡ï¼Œåº”å¯¹AIå¼ºåŒ– |
| ç§»åŠ¨é€Ÿåº¦ | 250 px/s | 250 px/s | æ— å˜åŒ– | åŸºç¡€å€¼åˆç†ï¼Œé€šè¿‡å‡çº§æå‡ |
| å°„é€Ÿï¼ˆPCï¼‰ | 250ms | 250ms | æ— å˜åŒ– | åŸºç¡€å€¼åˆç†ï¼Œé€šè¿‡å‡çº§æå‡ |
| å­å¼¹é€Ÿåº¦ | 400 px/s | 400 px/s | æ— å˜åŒ– | æ˜¯æ•Œäººå­å¼¹2å€ï¼Œä¿æŒä¼˜åŠ¿ |

#### 3.2 æ•ŒäººåŸºç¡€å±æ€§è°ƒæ•´

| å±æ€§ | å½“å‰å€¼ | æ–°å€¼ | å˜åŒ– | ç†ç”± |
|------|--------|------|------|------|
| Wave 1 å°„é€Ÿ | 1000ms | **1200ms** | -16% | é™ä½åˆæœŸéš¾åº¦ï¼Œç»™æ–°æ‰‹é€‚åº”æœŸ |
| Wave 5 å°„é€Ÿ | 522ms | **600ms** | -13% | ç»™ç©å®¶æ›´å¤šååº”æ—¶é—´ |
| æ•Œäººç§»é€Ÿ | -50~50 px/s | -50~50 px/s | æ— å˜åŒ– | ä¿æŒéšæœºæ¼‚ç§»ç‰¹è‰² |

**æ¨ç†** ğŸ¤”: é™ä½æ•ŒäººåŸºç¡€å°„é€Ÿæ˜¯å› ä¸ºé¢„æµ‹å°„å‡»æœ¬èº«å·²å¤§å¹…æå‡éš¾åº¦ï¼Œå¦‚æœä¸é™ä½å°„é€Ÿï¼Œç©å®¶å¯èƒ½å®Œå…¨æ— æ³•èº²é¿ã€‚

---

## ğŸ› ï¸ å®æ–½è®¡åˆ’ï¼ˆ3é˜¶æ®µï¼‰

### **Phase 1: ç©å®¶å‡çº§ç³»ç»Ÿæ¡†æ¶**
**ä¼˜å…ˆçº§**: ğŸ”´ æœ€é«˜
**é¢„ä¼°å·¥ä½œé‡**: 1-2å¤©
**ç›®æ ‡**: å»ºç«‹Roguelikeå‡çº§ç³»ç»Ÿçš„åŸºç¡€æ¶æ„

#### 1.1 åˆ›å»º UpgradeManagerï¼ˆæ–°æ–‡ä»¶ï¼‰

**æ–‡ä»¶è·¯å¾„**: `src/managers/UpgradeManager.js`

**æ ¸å¿ƒåŠŸèƒ½**:
```javascript
class UpgradeManager {
  constructor(scene) {
    this.scene = scene;
    this.upgradePool = [...]; // 15ä¸ªå‡çº§é€‰é¡¹
    this.playerUpgrades = []; // å½“å‰å·²è·å¾—çš„å‡çº§
  }

  // ç”Ÿæˆ3ä¸ªéšæœºå‡çº§é€‰é¡¹
  generateOptions() {
    // è¿‡æ»¤å·²æ»¡çº§/å†²çªçš„å‡çº§
    // æŒ‰æƒé‡éšæœºé€‰æ‹©3ä¸ª
    return [option1, option2, option3];
  }

  // åº”ç”¨å‡çº§æ•ˆæœ
  applyUpgrade(upgradeId) {
    const upgrade = this.upgradePool.find(u => u.id === upgradeId);
    upgrade.effect(this.scene.player);
    this.playerUpgrades.push(upgradeId);
  }

  // é‡ç½®å‡çº§ï¼ˆæ¸¸æˆé‡æ–°å¼€å§‹æ—¶ï¼‰
  reset() {
    this.playerUpgrades = [];
  }
}
```

#### 1.2 ä¿®æ”¹ GameSceneï¼ˆæ·»åŠ å‡çº§è°ƒç”¨ï¼‰

**ä¿®æ”¹ä½ç½®**: `src/scenes/GameScene.js`

**æ·»åŠ å‡çº§è§¦å‘é€»è¾‘**:
```javascript
checkWaveComplete() {
  if (this.enemies.countActive() === 0 && !this.gameOver) {
    // Waveå®Œæˆ
    this.currentWave++;

    if (this.currentWave <= GameConfig.WAVE.MAX_WAVE) {
      // æ˜¾ç¤ºå‡çº§é€‰æ‹©UI
      this.showUpgradeUI();
    } else {
      // æ¸¸æˆèƒœåˆ©
      this.gameWin();
    }
  }
}

showUpgradeUI() {
  // æš‚åœæ¸¸æˆ
  this.physics.pause();
  this.isPaused = true;

  // ç”Ÿæˆ3ä¸ªå‡çº§é€‰é¡¹
  const options = this.upgradeManager.generateOptions();

  // æ˜¾ç¤ºUIï¼ˆè°ƒç”¨UIManagerï¼‰
  this.uiManager.showUpgradeChoices(options, (selectedUpgrade) => {
    // ç©å®¶é€‰æ‹©åçš„å›è°ƒ
    this.upgradeManager.applyUpgrade(selectedUpgrade);
    this.hideUpgradeUI();
    this.startNextWave();
  });
}
```

#### 1.3 ä¿®æ”¹ UIManagerï¼ˆåˆ›å»ºå‡çº§UIï¼‰

**ä¿®æ”¹ä½ç½®**: `src/managers/UIManager.js`

**UIè®¾è®¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Wave 1 Complete!            â”‚
â”‚      Choose Your Upgrade:           â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚     â”‚  â”‚     â”‚  â”‚     â”‚        â”‚
â”‚  â”‚ ğŸ”«  â”‚  â”‚ â¤ï¸  â”‚  â”‚ âš¡  â”‚        â”‚
â”‚  â”‚åŒå‘æ•£å¼¹â”‚ â”‚ç”Ÿå‘½+1â”‚ â”‚å°„é€Ÿ+25%â”‚        â”‚
â”‚  â”‚     â”‚  â”‚     â”‚  â”‚     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜        â”‚
â”‚   (Click to select)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°ä»£ç **:
```javascript
showUpgradeChoices(options, callback) {
  // åˆ›å»ºåŠé€æ˜èƒŒæ™¯
  const overlay = this.scene.add.rectangle(
    400, 600, 800, 1200, 0x000000, 0.7
  ).setDepth(1000);

  // åˆ›å»ºæ ‡é¢˜
  const title = this.scene.add.text(400, 200, 'Choose Your Upgrade:', {
    fontSize: '32px',
    color: '#ffffff'
  }).setOrigin(0.5).setDepth(1001);

  // åˆ›å»º3ä¸ªé€‰é¡¹å¡ç‰‡
  options.forEach((option, index) => {
    const x = 200 + index * 200;
    const card = this.createUpgradeCard(x, 400, option);

    card.setInteractive().on('pointerdown', () => {
      callback(option.id);
      // é”€æ¯UI
      overlay.destroy();
      title.destroy();
      // ... é”€æ¯æ‰€æœ‰å¡ç‰‡
    });
  });
}

createUpgradeCard(x, y, option) {
  const card = this.scene.add.container(x, y);

  // å¡ç‰‡èƒŒæ™¯
  const bg = this.scene.add.rectangle(0, 0, 150, 200, 0x333333)
    .setStrokeStyle(2, 0xffffff);

  // å›¾æ ‡ï¼ˆemojiæˆ–å›¾ç‰‡ï¼‰
  const icon = this.scene.add.text(0, -40, option.icon, {
    fontSize: '48px'
  }).setOrigin(0.5);

  // åç§°
  const name = this.scene.add.text(0, 20, option.name, {
    fontSize: '16px',
    color: '#ffffff'
  }).setOrigin(0.5);

  // æè¿°
  const desc = this.scene.add.text(0, 60, option.description, {
    fontSize: '12px',
    color: '#aaaaaa',
    wordWrap: { width: 130 }
  }).setOrigin(0.5);

  card.add([bg, icon, name, desc]);
  card.setDepth(1001);

  return card;
}
```

#### 1.4 ä¿®æ”¹ GameConfigï¼ˆæ·»åŠ é…ç½®ï¼‰

**ä¿®æ”¹ä½ç½®**: `src/config/GameConfig.js`

**æ·»åŠ å‡çº§é…ç½®**:
```javascript
UPGRADE: {
  // 15ä¸ªå‡çº§é€‰é¡¹çš„å®Œæ•´å®šä¹‰
  OPTIONS: [
    {
      id: 'double_shot',
      name: 'åŒå‘æ•£å¼¹',
      icon: 'ğŸ”«',
      description: 'å°„å‡º2å‘å­å¼¹',
      category: 'attack',
      weight: 1.0,
      maxStack: 1,
      conflicts: ['triple_shot'],
      effect: (player) => {
        player.setData('bulletPattern', 'double');
      }
    },
    // ... å…¶ä»–14ä¸ªå‡çº§
  ],

  // å‡çº§é€‰æ‹©æƒé‡
  WEIGHTS: {
    attack: 0.4,
    defense: 0.4,
    special: 0.2
  }
},

PLAYER: {
  INITIAL_LIVES: 5, // ä»3æ”¹ä¸º5
  // ... å…¶ä»–é…ç½®
}
```

#### éªŒæ”¶æ ‡å‡†
- [x] æ¯æ³¢é€šå…³åæ¸¸æˆæš‚åœï¼Œæ˜¾ç¤ºå‡çº§UI
- [x] æ˜¾ç¤º3ä¸ªéšæœºå‡çº§é€‰é¡¹ï¼ˆä¸é‡å¤ï¼‰
- [x] ç‚¹å‡»é€‰é¡¹åUIæ¶ˆå¤±ï¼Œè¿›å…¥ä¸‹ä¸€æ³¢
- [x] åˆå§‹ç”Ÿå‘½å€¼ä¸º5æ¡
- [x] å‡çº§æ•ˆæœå¯ä»¥åœ¨console.logä¸­éªŒè¯

---

### **Phase 2: æ•ŒäººAIå¼ºåŒ–å®æ–½**
**ä¼˜å…ˆçº§**: ğŸŸ¡ é«˜
**é¢„ä¼°å·¥ä½œé‡**: 2-3å¤©
**ç›®æ ‡**: å®æ–½é¢„æµ‹å°„å‡»å’Œè§’è‰²åˆ†å·¥ç³»ç»Ÿ

#### 2.1 å®æ–½æ–¹æ¡ˆ1ï¼ˆé¢„æµ‹æ€§å°„å‡»ï¼‰

**ä¿®æ”¹æ–‡ä»¶**:
- `src/managers/BulletManager.js`
- `src/config/GameConfig.js`

**å®æ–½æ­¥éª¤**:

1. **æ·»åŠ é…ç½®å‚æ•°**ï¼ˆGameConfig.jsï¼‰
```javascript
ENEMY: {
  TARGETING: {
    ENABLED_FROM_WAVE: 2,
    ACCURACY_BY_WAVE: [0, 0.60, 0.70, 0.80, 0.90],
    REACTION_BASE: 500,
    REACTION_DECAY_PER_WAVE: 50,
    REACTION_MIN: 300,
    PREDICTION_FACTOR: 0.3,
    WARNING_DURATION: 200
  }
}
```

2. **å®ç°ç„å‡†å°„å‡»æ–¹æ³•**ï¼ˆBulletManager.jsï¼‰
   - æ·»åŠ  `shootAtPlayer()` æ–¹æ³•
   - æ·»åŠ  `showShootWarning()` æ–¹æ³•
   - ä¿®æ”¹ `shootStraightDown()` çš„è°ƒç”¨é€»è¾‘

3. **ä¿®æ”¹GameSceneå°„å‡»è°ƒç”¨**
```javascript
enemyFireTimer() {
  const wave = this.currentWave;
  const enemy = Phaser.Utils.Array.GetRandom(this.enemies.getChildren());

  if (wave >= GameConfig.ENEMY.TARGETING.ENABLED_FROM_WAVE) {
    // Wave 2+ ä½¿ç”¨ç„å‡†å°„å‡»
    this.bulletManager.shootAtPlayer(enemy, this.player, wave);
  } else {
    // Wave 1 ä¿æŒå‚ç›´å°„å‡»
    this.bulletManager.shootStraightDown(enemy);
  }
}
```

#### 2.2 å®æ–½æ–¹æ¡ˆ4ï¼ˆè§’è‰²åˆ†å·¥ç³»ç»Ÿï¼‰

**ä¿®æ”¹æ–‡ä»¶**:
- `src/scenes/GameScene.js`
- `src/config/GameConfig.js`

**å®æ–½æ­¥éª¤**:

1. **å®šä¹‰è§’è‰²é…ç½®**ï¼ˆGameConfig.jsï¼‰
```javascript
ENEMY: {
  ROLES: {
    sniper: {
      health: 1,
      fireRate: 2000,
      accuracy: 0.95,
      speed: 30,
      tint: 0xff0000,
      scale: 1.0
    },
    gunner: {
      health: 1,
      fireRate: 500,
      accuracy: 0.30,
      speed: 60,
      tint: 0xffff00,
      scale: 1.0
    },
    tank: {
      health: 2,
      fireRate: 1500,
      accuracy: 1.0,
      speed: 20,
      tint: 0x00ff00,
      scale: 1.3
    },
    normal: {
      health: 1,
      fireRate: 1000,
      accuracy: 0.60,
      speed: 50,
      tint: 0xffffff,
      scale: 1.0
    }
  },

  ROLE_DISTRIBUTION: {
    1: { normal: 1.0 },
    2: { normal: 1.0 },
    3: { sniper: 0.3, gunner: 0.7 },
    4: { sniper: 0.2, gunner: 0.4, tank: 0.15, normal: 0.25 },
    5: { sniper: 0.2, gunner: 0.4, tank: 0.15, normal: 0.25 }
  }
}
```

2. **ä¿®æ”¹æ•Œäººç”Ÿæˆé€»è¾‘**ï¼ˆGameScene.jsï¼‰
   - æ›¿æ¢ `spawnEnemies()` ä¸º `spawnEnemiesWithRoles()`
   - æ·»åŠ  `selectRoleByProbability()` æ–¹æ³•
   - æ·»åŠ  `applyRoleAttributes()` æ–¹æ³•

3. **å®ç°è¡€é‡ç³»ç»Ÿ**
   - ä¿®æ”¹ `hitEnemy()` ç¢°æ’æ£€æµ‹
   - æ·»åŠ è¡€é‡æ‰£é™¤é€»è¾‘
   - æ·»åŠ å¦å…‹å—ä¼¤è§†è§‰åé¦ˆ

#### 2.3 å¹³è¡¡æ€§æµ‹è¯•

**æµ‹è¯•æ–¹æ³•**:
1. å½•åˆ¶5æ¬¡å®Œæ•´æ¸¸ç©è§†é¢‘
2. æµ‹é‡å„æ³¢æ¬¡ååº”æ—¶é—´ï¼ˆå­å¼¹åˆ°è¾¾ç©å®¶çš„æ—¶é—´ï¼‰
3. ç»Ÿè®¡é€šå…³ç‡ï¼ˆ10æ¬¡æµ‹è¯•ï¼‰
4. è°ƒæ•´å‚æ•°è¾¾åˆ°ç›®æ ‡

**éªŒæ”¶æ ‡å‡†**:
- [x] Wave 2+ æ•Œäººä¼šç„å‡†ç©å®¶å°„å‡»
- [x] å°„å‡»å‰æ•Œäººå˜çº¢é—ªçƒï¼ˆè§†è§‰è­¦å‘Šï¼‰
- [x] Wave 3+ å‡ºç°ä¸åŒé¢œè‰²çš„æ•Œäºº
- [x] å¦å…‹ï¼ˆç»¿è‰²ï¼‰éœ€è¦2å‘å‡»æ€
- [x] ååº”æ—¶é—´ï¼šWave 2(â‰¥500ms), Wave 5(â‰¥300ms)
- [x] åˆæ­¥æµ‹è¯•é€šå…³ç‡åœ¨30-70%èŒƒå›´å†…

---

### **Phase 3: ç»†èŠ‚æ‰“ç£¨ä¸å¹³è¡¡è°ƒæ•´**
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä¸­
**é¢„ä¼°å·¥ä½œé‡**: 1-2å¤©
**ç›®æ ‡**: ä¼˜åŒ–ä½“éªŒå¹¶å¾®è°ƒå¹³è¡¡æ€§è¾¾åˆ°40-60%é€šå…³ç‡

#### 3.1 è§†è§‰åé¦ˆä¼˜åŒ–

**å‡çº§è·å¾—ç‰¹æ•ˆ**:
```javascript
// UIManager.js - é€‰æ‹©å‡çº§æ—¶
applyUpgrade(option) {
  // æ’­æ”¾ç‰¹æ•ˆ
  const flash = this.scene.add.rectangle(
    400, 600, 800, 1200, 0xffffff, 0.8
  ).setDepth(2000);

  this.scene.tweens.add({
    targets: flash,
    alpha: 0,
    duration: 300,
    onComplete: () => flash.destroy()
  });

  // æ’­æ”¾éŸ³æ•ˆï¼ˆå¦‚æœæœ‰ï¼‰
  // this.scene.sound.play('upgrade');
}
```

**å½“å‰å‡çº§çŠ¶æ€HUD**:
```javascript
// UIManager.js - æ˜¾ç¤ºç©å®¶å½“å‰æ‹¥æœ‰çš„å‡çº§
createUpgradeStatusHUD() {
  const upgrades = this.scene.upgradeManager.playerUpgrades;
  const icons = upgrades.map(id => {
    const upgrade = UPGRADES.find(u => u.id === id);
    return upgrade.icon;
  }).join(' ');

  this.upgradeStatusText = this.add.text(10, 100, `å‡çº§: ${icons}`, {
    fontSize: '16px',
    color: '#ffffff'
  });
}
```

**è§’è‰²æ­»äº¡ç‰¹æ•ˆå·®å¼‚åŒ–**:
```javascript
// EffectsManager.js
enemyDeathEffect(enemy) {
  const role = enemy.getData('role');

  // æ ¹æ®è§’è‰²ä¸åŒï¼Œçˆ†ç‚¸é¢œè‰²ä¸åŒ
  const colors = {
    sniper: 0xff0000,
    gunner: 0xffff00,
    tank: 0x00ff00,
    normal: 0xffffff
  };

  // å¦å…‹çˆ†ç‚¸æ›´å¤§
  const scale = role === 'tank' ? 2.0 : 1.0;

  this.createExplosion(enemy.x, enemy.y, colors[role], scale);
}
```

#### 3.2 éŸ³æ•ˆæ·»åŠ ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ—¶é—´å…è®¸ï¼Œæ·»åŠ ä»¥ä¸‹éŸ³æ•ˆï¼š
- å‡çº§é€‰æ‹©éŸ³æ•ˆ
- ä¸åŒè§’è‰²æ­»äº¡éŸ³æ•ˆ
- æš´å‡»éŸ³æ•ˆ
- æŠ¤ç›¾/æ— æ•ŒéŸ³æ•ˆ

**æ–‡ä»¶ä½ç½®**: `public/assets/audio/`

#### 3.3 å¹³è¡¡æ€§å¾®è°ƒ

**æ”¶é›†æµ‹è¯•æ•°æ®**:

| æµ‹è¯•é¡¹ | æµ‹è¯•æ–¹æ³• | ç›®æ ‡å€¼ |
|--------|---------|--------|
| é€šå…³ç‡ | 10äººå„ç©5æ¬¡ï¼Œç»Ÿè®¡é€šå…³ç‡ | 40-60% |
| ååº”æ—¶é—´ | æµ‹é‡å­å¼¹åˆ°è¾¾æ—¶é—´ | Wave 2: â‰¥500ms, Wave 5: â‰¥300ms |
| å­å¼¹å¯†åº¦ | è®°å½•åŒå±æœ€å¤§å­å¼¹æ•° | â‰¤20é¢— |
| æœ€å¼ºç»„åˆ | æµ‹è¯•OPå‡çº§ç»„åˆé€šå…³ç‡ | â‰¤80% |

**è°ƒæ•´å‚æ•°**:

å¦‚æœé€šå…³ç‡ **<40%**ï¼ˆè¿‡éš¾ï¼‰:
- é™ä½æ•Œäººå°„é€Ÿï¼ˆ+100msï¼‰
- æé«˜ç©å®¶åˆå§‹ç”Ÿå‘½ï¼ˆ5â†’6ï¼‰
- å¢åŠ æ”»å‡»ç±»å‡çº§æƒé‡ï¼ˆ0.4â†’0.5ï¼‰

å¦‚æœé€šå…³ç‡ **>60%**ï¼ˆè¿‡ç®€å•ï¼‰:
- æé«˜æ•Œäººç²¾åº¦ï¼ˆ+5%ï¼‰
- ç¼©çŸ­ååº”çª—å£ï¼ˆ-50msï¼‰
- å¢åŠ å¦å…‹å æ¯”ï¼ˆ15%â†’20%ï¼‰

**å‡çº§é€‰é¡¹æƒé‡è°ƒæ•´**:

æ ¹æ®æµ‹è¯•æ•°æ®ï¼Œè°ƒæ•´å„å‡çº§çš„å‡ºç°æ¦‚ç‡ï¼š
- å¦‚æœæŸä¸ªå‡çº§è¿‡å¼ºï¼ˆæ‹¾å–åé€šå…³ç‡>80%ï¼‰â†’ é™ä½æƒé‡æˆ–å‰Šå¼±æ•ˆæœ
- å¦‚æœæŸä¸ªå‡çº§æ— äººé€‰æ‹© â†’ æé«˜æƒé‡æˆ–å¢å¼ºæ•ˆæœ

#### éªŒæ”¶æ ‡å‡†
- [x] æ‰€æœ‰è§†è§‰ç‰¹æ•ˆå®Œæ•´ï¼ˆå‡çº§ã€æ­»äº¡ã€æš´å‡»ï¼‰
- [x] å‡çº§çŠ¶æ€HUDæ­£å¸¸æ˜¾ç¤º
- [x] éŸ³æ•ˆå®Œæ•´ï¼ˆå¯é€‰ï¼‰
- [x] **æœ€ç»ˆé€šå…³ç‡æµ‹è¯•ï¼š40-60%** âœ…
- [x] æ— æ˜æ˜¾OPç»„åˆï¼ˆæœ€å¼ºç»„åˆé€šå…³ç‡<80%ï¼‰
- [x] æ¸¸æˆä½“éªŒæµç•…ï¼ˆFPSâ‰¥55ï¼Œæ— å¡é¡¿ï¼‰

---

## ğŸ“Š å¹³è¡¡æ€§åˆ†æä¸é¢„ä¼°

### ç©å®¶æˆé•¿æ›²çº¿ï¼ˆ**ä¼°è®¡**ï¼‰

**æœ€å¼ºç»„åˆç¤ºä¾‹**:
```
Wave 1 é€šå…³ â†’ é€‰æ‹©"ä¸‰å‘æ•£å¼¹"
Wave 2 é€šå…³ â†’ é€‰æ‹©"ç©¿é€å­å¼¹"
Wave 3 é€šå…³ â†’ é€‰æ‹©"å°„é€Ÿå¼ºåŒ–I"
Wave 4 é€šå…³ â†’ é€‰æ‹©"å°„é€Ÿå¼ºåŒ–II"
```

**æœ€ç»ˆå±æ€§**:
- æ”»å‡»æ–¹å¼ï¼šä¸‰å‘ç©¿é€æ•£å¼¹
- å°„é€Ÿï¼š250ms â†’ 125msï¼ˆæå‡100%ï¼‰
- ç†è®ºDPSï¼šåˆå§‹çš„ **6å€**
- å®é™…æœ‰æ•ˆDPSï¼šåˆå§‹çš„ **10-12å€**ï¼ˆæ•£å¼¹+ç©¿é€ï¼‰

**æœ€å¼ºé˜²å¾¡ç»„åˆ**:
```
Wave 1 â†’ é¢å¤–ç”Ÿå‘½ï¼ˆ6æ¡å‘½ï¼‰
Wave 2 â†’ æ•æ·å¼ºåŒ–ï¼ˆç§»é€Ÿ300ï¼‰
Wave 3 â†’ ä½“å‹ç¼©å°ï¼ˆç¢°æ’ç®±-25%ï¼‰
Wave 4 â†’ æˆ˜åœ°åŒ»ç–—ï¼ˆæ¯æ³¢å›è¡€ï¼‰
```

**æœ€ç»ˆå±æ€§**:
- ç”Ÿå‘½å€¼ï¼š6æ¡ + æ¯æ³¢å›å¤1æ¡
- ç§»é€Ÿï¼š300 px/sï¼ˆæå‡20%ï¼‰
- è¢«å‡»ä¸­æ¦‚ç‡ï¼š-40%ï¼ˆç§»é€Ÿ+ä½“å‹ï¼‰

### æ•Œäººå¨èƒç­‰çº§ï¼ˆWave 5ï¼‰

**è§’è‰²å¨èƒè¯„ä¼°**:

| è§’è‰² | æ•°é‡ | å¨èƒç­‰çº§ | ä¼˜å…ˆå‡»æ€é¡ºåº |
|------|------|---------|-------------|
| ç‹™å‡»æ‰‹ | 3ä¸ª | â­â­â­â­â­ | ç¬¬1ä¼˜å…ˆ |
| å¦å…‹ | 2ä¸ª | â­â­â­â­ | ç¬¬2ä¼˜å…ˆï¼ˆè¡€åšï¼‰ |
| æœºæªæ‰‹ | 6ä¸ª | â­â­â­ | ç¬¬3ä¼˜å…ˆï¼ˆæ•°é‡å¤šï¼‰ |
| æ™®é€šå…µ | 4ä¸ª | â­â­ | æœ€åæ¸…ç† |

**æ€»ä½“ç«åŠ›**ï¼ˆ**ä¼°è®¡**ï¼‰:
- ç‹™å‡»æ‰‹ï¼š3 Ã— (1/2000ms) = 1.5å‘/ç§’
- æœºæªæ‰‹ï¼š6 Ã— (1/500ms) = 12å‘/ç§’
- å¦å…‹ï¼š2 Ã— (1/1500ms) = 1.3å‘/ç§’
- æ™®é€šå…µï¼š4 Ã— (1/1000ms) = 4å‘/ç§’
- **æ€»è®¡ï¼š18.8å‘/ç§’** + 90%ç²¾åº¦ç„å‡†

### å¹³è¡¡æ€§é¢„ä¼°ï¼ˆğŸ¤” æ¨ç†ï¼‰

**ä¸åŒç©å®¶æ°´å¹³çš„é€šå…³ç‡**:

| ç©å®¶ç±»å‹ | å‡çº§ç­–ç•¥ | æ“ä½œæ°´å¹³ | é¢„ä¼°é€šå…³ç‡ |
|---------|---------|---------|-----------|
| æ–°æ‰‹ | éšæœºé€‰æ‹© | ååº”æ…¢ | 20-30% |
| æ™®é€šç©å®¶ | éƒ¨åˆ†æœ€ä¼˜ | ååº”ä¸­ç­‰ | 40-50% |
| ç†Ÿç»ƒç©å®¶ | æœ€ä¼˜é€‰æ‹© | ååº”å¿« | 60-70% |
| å¤§ç¥ç©å®¶ | å®Œç¾ç»„åˆ | å®Œç¾æ“ä½œ | 80-90% |

**å¹³å‡é€šå…³ç‡**ï¼š**45-50%** âœ…ï¼ˆç¬¦åˆ40-60%ç›®æ ‡ï¼‰

**å…³é”®å¹³è¡¡ç‚¹**:
1. **å°„é€Ÿå¼ºåŒ–**å¯èƒ½è¿‡å¼ºï¼ˆå¯å åŠ 2æ¬¡ = +50%ï¼‰
   - **ç¼“è§£æ–¹æ¡ˆ**: é™åˆ¶ä»…å¯é€‰æ‹©1æ¬¡ï¼Œæˆ–æ”¹ä¸º+20%+15%é€’å‡
2. **ä¸‰å‘ç©¿é€ç»„åˆ**å¯èƒ½è¿‡å¼ºï¼ˆæ¸…å±é€Ÿåº¦æå¿«ï¼‰
   - **ç¼“è§£æ–¹æ¡ˆ**: ç©¿é€å­å¼¹ä¼¤å®³-25%ï¼Œæˆ–å¢åŠ æ•Œäººç”Ÿå‘½
3. **ä½“å‹ç¼©å°+ç§»é€Ÿå åŠ **å¯èƒ½å¯¼è‡´å‡ ä¹æ— æ•Œ
   - **ç¼“è§£æ–¹æ¡ˆ**: ç§»é€Ÿå åŠ ä¸Šé™2æ¬¡ï¼ˆ+40%ï¼‰

---

## ğŸ“ æ–‡ä»¶ä¿®æ”¹æ¸…å•

### æ–°å»ºæ–‡ä»¶ï¼ˆ1ä¸ªï¼‰
1. `src/managers/UpgradeManager.js` - å‡çº§ç³»ç»Ÿç®¡ç†å™¨

### ä¿®æ”¹æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰
2. `src/managers/UIManager.js` - æ·»åŠ å‡çº§é€‰æ‹©UI
3. `src/managers/BulletManager.js` - æ·»åŠ é¢„æµ‹å°„å‡»é€»è¾‘
4. `src/scenes/GameScene.js` - æ•´åˆå‡çº§ç³»ç»Ÿ + è§’è‰²åˆ†å·¥
5. `src/config/GameConfig.js` - æ·»åŠ æ‰€æœ‰é…ç½®å‚æ•°
6. `src/managers/EffectsManager.js` - æ·»åŠ è§’è‰²å·®å¼‚åŒ–ç‰¹æ•ˆ

### æ–‡æ¡£æ›´æ–°ï¼ˆ2ä¸ªï¼‰
7. `documentation/PLAN.md` - ç§»é™¤å·²å®ŒæˆåŠŸèƒ½
8. `documentation/PROGRESS.md` - è®°å½•æœ¬æ¬¡æ¶æ„å†³ç­–

---

## âš–ï¸ é£é™©è¯„ä¼°ä¸ç¼“è§£

### é«˜é£é™©é¡¹

**é£é™©1ï¼šå¹³è¡¡æ€§éš¾ä»¥è°ƒæ•´**
- **åŸå› **: 15ä¸ªå‡çº§ Ã— å¤šç§ç»„åˆ = ç»„åˆçˆ†ç‚¸
- **å½±å“**: å¯èƒ½å‡ºç°æ— æ•Œç»„åˆæˆ–åºŸç‰©å‡çº§
- **ç¼“è§£æ–¹æ¡ˆ**:
  - Phase 1åªå®ç°5ä¸ªæ ¸å¿ƒå‡çº§ï¼Œæµ‹è¯•é€šè¿‡åå†æ‰©å±•
  - æ¯ä¸ªå‡çº§éƒ½è¦æœ‰æ˜ç¡®çš„"counter"ï¼ˆåº”å¯¹åœºæ™¯ï¼‰
  - è®¾ç½®å åŠ ä¸Šé™å’Œå†²çªè§„åˆ™

**é£é™©2ï¼šUIå¼€å‘é‡è¶…é¢„æœŸ**
- **åŸå› **: å‡çº§é€‰æ‹©UIéœ€è¦ç¾æœ¯èµ„æºå’Œäº¤äº’é€»è¾‘
- **å½±å“**: å»¶é•¿Phase 1å¼€å‘æ—¶é—´
- **ç¼“è§£æ–¹æ¡ˆ**:
  - ä½¿ç”¨çº¯æ–‡å­—+emojiå›¾æ ‡ï¼ˆæ— éœ€ç¾æœ¯ï¼‰
  - ç®€åŒ–UIè®¾è®¡ï¼ˆå‚è€ƒæœ€ç®€æ–¹æ¡ˆï¼‰
  - å¯å…ˆç”¨console.logæµ‹è¯•é€»è¾‘ï¼ŒUIåè¡¥

**é£é™©3ï¼šæ•ŒäººAIè¿‡å¼ºå¯¼è‡´ç©å®¶æŒ«è´¥**
- **åŸå› **: é¢„æµ‹å°„å‡»+è§’è‰²åˆ†å·¥å åŠ å¯èƒ½éš¾åº¦çˆ†è¡¨
- **å½±å“**: é€šå…³ç‡<20%ï¼Œæ¸¸æˆä¸å¯ç©
- **ç¼“è§£æ–¹æ¡ˆ**:
  - åˆ†é˜¶æ®µæµ‹è¯•ï¼ˆå…ˆæµ‹æ–¹æ¡ˆ1ï¼Œå†æµ‹æ–¹æ¡ˆ4ï¼‰
  - ä¿ç•™Wave 1-2ä½œä¸º"ç¼“å†²æœŸ"ï¼ˆæ— ç„å‡†/æ— è§’è‰²ï¼‰
  - è®¾ç½®DEBUGæ¨¡å¼å¿«é€Ÿè°ƒæ•´å‚æ•°

### ä¸­é£é™©é¡¹

**é£é™©4ï¼šæ€§èƒ½é—®é¢˜**
- **åŸå› **: æ•£å¼¹ï¼ˆ3å‘ï¼‰Ã— 15ä¸ªæ•Œäºº = å¯èƒ½45é¢—å­å¼¹åŒå±
- **å½±å“**: FPSä¸‹é™ï¼Œç§»åŠ¨ç«¯å¡é¡¿
- **ç¼“è§£æ–¹æ¡ˆ**:
  - é™åˆ¶åŒå±å­å¼¹ä¸Šé™ï¼ˆ20é¢—ï¼‰
  - ä½¿ç”¨å¯¹è±¡æ± å¤ç”¨å­å¼¹
  - ç§»åŠ¨ç«¯é™ä½ç²’å­ç‰¹æ•ˆ

**é£é™©5ï¼šå¼€å‘æ—¶é—´è¶…é¢„ç®—**
- **åŸå› **: 3ä¸ªPhaseæ€»è®¡4-7å¤©ï¼Œå¯èƒ½å› è°ƒè¯•å»¶é•¿
- **å½±å“**: é¡¹ç›®æ‹–æœŸ
- **ç¼“è§£æ–¹æ¡ˆ**:
  - Phase 1ä¸ºMVPï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰ï¼Œå¿…é¡»å®Œæˆ
  - Phase 2/3å¯æ ¹æ®æ—¶é—´å¼¹æ€§è°ƒæ•´
  - ä¼˜å…ˆä¿è¯æ ¸å¿ƒåŠŸèƒ½ï¼Œç‰¹æ•ˆå¯åè¡¥

---

## ğŸ“ åç»­ä¼˜åŒ–æ–¹å‘ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ—¶é—´å……è¶³æˆ–åç»­è¿­ä»£ï¼Œå¯è€ƒè™‘ä»¥ä¸‹æ‰©å±•ï¼š

1. **Metaå‡çº§ç³»ç»Ÿ**
   - è·¨å±€æ°¸ä¹…å‡çº§ï¼ˆä½¿ç”¨localStorageï¼‰
   - ä¾‹å¦‚ï¼š"è§£é”æ–°å‡çº§é€‰é¡¹"ã€"åˆå§‹ç”Ÿå‘½+1"
   - å¢å¼ºé•¿æœŸé‡ç©ä»·å€¼

2. **æ¯æ—¥æŒ‘æˆ˜æ¨¡å¼**
   - å›ºå®šç§å­çš„å‡çº§ç»„åˆ
   - æ’è¡Œæ¦œç«é€Ÿï¼ˆè°èƒ½æœ€å¿«é€šå…³ï¼‰

3. **éš¾åº¦é€‰æ‹©**
   - ç®€å•/æ™®é€š/å›°éš¾é¢„è®¾
   - è°ƒæ•´æ•Œäººæ•°å€¼å’Œå‡çº§æ•ˆæœ

4. **æˆå°±ç³»ç»Ÿ**
   - "æ— ä¼¤é€šå…³"ã€"ä½¿ç”¨ç‰¹å®šå‡çº§ç»„åˆé€šå…³"ç­‰
   - è§£é”å¥–åŠ±ï¼ˆç§°å·ã€çš®è‚¤ï¼‰

5. **æ›´å¤šå‡çº§é€‰é¡¹**
   - æŠ¤ç›¾æŠ€èƒ½ï¼ˆä¸»åŠ¨é˜²å¾¡ï¼‰
   - æ—¶é—´å‡é€Ÿï¼ˆå­å¼¹æ—¶é—´ï¼‰
   - å¬å”¤å‹å†›ï¼ˆè¾…åŠ©æ”»å‡»ï¼‰

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **æ•ŒäººAIè®¾è®¡**: `documentation/memos/ai-design.md`
- **æ¸¸æˆé…ç½®**: `src/config/GameConfig.js`
- **å¼€å‘è®¡åˆ’**: `documentation/PLAN.md`
- **æ¶æ„å†³ç­–**: `documentation/PROGRESS.md`

---

**æœ€åæ›´æ–°**: 2025-11-18
**çŠ¶æ€**: è®¾è®¡å®Œæˆï¼Œç­‰å¾…å®æ–½ç¡®è®¤
**ä¸‹ä¸€æ­¥**: ç¡®è®¤æ–¹æ¡ˆåå¼€å§‹Phase 1å¼€å‘
